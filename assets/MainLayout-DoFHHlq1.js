import{Q as V,a as S,z as P,b as K,c as Z}from"./vue-boring-avatars-CqabYJ2U.js";import{i as x,j as ee,r as U,o as D,e as r,k as i,Q as w,_ as ae,u as te,l as oe,m as le,n as H,w as ne,d as se,p as re,q as a,s as ue,h as e,g as X,t as n,v as f,f as C,x as Y,y as s,z as v,A as y,F as E,B as A,C as g,D as de}from"./index-Y1q3RxoI.js";import{Q as k}from"./QItemLabel-B8jZg-I0.js";import{Q as d,a as l}from"./QItem-BYZ5MaxK.js";import{Q as I}from"./QList-B4bk0qsK.js";import{Q as ie}from"./use-id-eM9t2YxV.js";import{Q as me}from"./QBtnDropdown-uuIA0cLX.js";import{Q as L}from"./QSeparator-DRfcuWxi.js";import{C as b}from"./ClosePopup-CROo6fiG.js";import{u as ce}from"./use-quasar-D9aSB_kD.js";import{u as fe}from"./useLocomotiveScroll-BtgJXPSf.js";import"./use-prevent-scroll-BguVKd-5.js";import"./use-timeout-CmHpihJi.js";import"./use-dark-ekWLNdeH.js";import"./TouchPan-frCyB8k9.js";import"./format-dCatN8Gn.js";import"./QBtnGroup-Iuvdmsyo.js";const pe=x({name:"QSpace",setup(){const T=ee("div",{class:"q-space"});return()=>T}}),N={__name:"ThemeToggle",setup(T){document.startViewTransition||(document.startViewTransition=t=>t());const m=U(!1);function $(t){document.startViewTransition(()=>{t==="dark"?(m.value=!0,document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(m.value=!1,document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))})}D(()=>{const t=localStorage.getItem("theme");(t==="dark"||!t&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(m.value=!0,document.documentElement.classList.add("dark"))});const q=t=>{const h=`${Math.floor(t.clientX/window.innerWidth*100)}%`,_=`${Math.floor(t.clientY/window.innerHeight*100)}%`;document.documentElement.style=`--pointerX: ${h}; --pointerY: ${_};`},c=t=>{const h=`${Math.floor(t.touches[0].clientX/window.innerWidth*100)}%`,_=`${Math.floor(t.touches[0].clientY/window.innerHeight*100)}%`;document.documentElement.style=`--pointerX: ${h}; --pointerY: ${_};`};return D(()=>{const t=localStorage.getItem("theme");(t==="dark"||!t&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(m.value=!0,document.documentElement.classList.add("dark")),document.addEventListener("mousedown",q),document.addEventListener("touchstart",c)}),(t,h)=>(r(),i(w,{flat:"",dense:"",round:"",icon:m.value?"dark_mode":"light_mode",onClick:h[0]||(h[0]=_=>$(m.value?"light":"dark")),class:"theme-toggle"},null,8,["icon"]))}},ve={key:0,class:"desktop-nav"},he={class:"mobile-menu-btn"},_e={__name:"MainLayout",setup(T){const m=te(),{t:$,locale:q}=oe(),c=le(),t=ce(),{destroyLocomotiveScroll:h}=fe(),_=H(()=>c.username?.toLowerCase()),M=["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"],u=U(!1),W=H(()=>(t.screen.lt.sm,280));function F(){m.push("/site"),u.value=!1}const R=o=>{q.value=o},z=async()=>{try{await c.logout(),t.notify({type:"positive",message:$("logout.success"),position:"top"}),m.push("/site/login"),u.value=!1}catch(o){console.error("Logout error:",o),t.notify({type:"negative",message:$("logout.error"),position:"top"})}},B=[{text:"繁體中文",value:"zh-TW"},{text:"English",value:"en-US"}];ne(()=>t.screen.name,o=>{(o==="md"||o==="lg"||o==="xl")&&(u.value=!1)}),m.afterEach(()=>{setTimeout(()=>{u.value=!1},100)}),D(()=>{console.log("元件掛載，目前螢幕類型:",t.screen.name),console.log("是否為行動裝置:",t.screen.lt.md),window.addEventListener("resize",()=>{console.log("螢幕大小變化，目前螢幕類型:",t.screen.name),console.log("是否為行動裝置:",t.screen.lt.md)});const o=document.createElement("style");o.innerHTML=`
    body.body--dark .q-menu,
    body.body--dark .q-popover,
    body.body--dark .q-tooltip {
      background-color: #1d1d1d !important;
      color: #ffffff !important;
    }

    body.body--dark .q-menu *,
    body.body--dark .q-popover *,
    body.body--dark .q-tooltip * {
      background-color: #1d1d1d !important;
    }
  `,document.head.appendChild(o)}),se(()=>{h()});const j=()=>{m.push("/"),u.value=!1},O=()=>{console.log("選單按鈕點擊，目前抽屜狀態:",u.value),u.value=!u.value,console.log("抽屜新狀態:",u.value)};return(o,Q)=>{const G=re("router-view");return r(),i(ue,{view:"hHh Lpr lff"},{default:a(()=>[e(K,{class:"main-header header-z-index fixed-header",bordered:""},{default:a(()=>[e(V,{class:"header-toolbar"},{default:a(()=>[e(S,{onClick:F,class:"cursor-pointer"},{default:a(()=>[X("span",null,n(o.$t("nav.title")),1)]),_:1}),e(pe),f(t).screen.lt.md?y("",!0):(r(),C("div",ve,[f(c).isLoggedIn?(r(),i(w,{key:1,flat:""},{default:a(()=>[e(Y,{size:"sm",class:"q-mr-sm"},{default:a(()=>[e(f(P),{size:25,variant:"beam",name:f(c).username,title:!0,colors:M},null,8,["name"])]),_:1}),s(" "+n(_.value)+" ",1),e(ie,null,{default:a(()=>[e(I,{style:{"min-width":"150px"}},{default:a(()=>[e(d,{clickable:"",onClick:z},{default:a(()=>[e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[e(v,{name:"logout",size:"sm",class:"q-mr-sm"}),s(" "+n(o.$t("nav.logout")),1)]),_:1})]),_:1})]),_:1}),e(d,{clickable:"",to:"/site/dashboard"},{default:a(()=>[e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[e(v,{name:"dashboard",size:"sm",class:"q-mr-sm"}),s(" "+n(o.$t("nav.dashboard")),1)]),_:1})]),_:1})]),_:1}),f(c).role==="admin"?(r(),i(d,{key:0,clickable:"",to:{name:"admin"}},{default:a(()=>[e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[e(v,{name:"admin_panel_settings",size:"sm",class:"q-mr-sm"}),s(" "+n(o.$t("nav.admin")),1)]),_:1})]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})]),_:1})):(r(),i(w,{key:0,flat:"",label:o.$t("nav.login"),to:"/site/login"},null,8,["label"])),e(me,{flat:"",icon:"translate"},{default:a(()=>[e(I,null,{default:a(()=>[(r(),C(E,null,A(B,p=>g(e(d,{key:p.value,clickable:"",onClick:J=>o.$i18n.locale=p.value},{default:a(()=>[e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[s(n(p.text),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]),[[b]])),64))]),_:1})]),_:1}),e(N)])),X("div",he,[f(t).screen.lt.md?(r(),i(w,{key:0,dense:"",flat:"",round:"",icon:"menu",onClick:O})):y("",!0)])]),_:1})]),_:1}),e(Z,{modelValue:u.value,"onUpdate:modelValue":Q[1]||(Q[1]=p=>u.value=p),side:"right",overlay:"",elevated:"",width:W.value,class:"mobile-drawer"},{default:a(()=>[e(V,{class:"drawer-header"},{default:a(()=>[e(S,null,{default:a(()=>[s(n(o.$t("nav.menu")),1)]),_:1}),e(w,{flat:"",round:"",dense:"",icon:"close",onClick:Q[0]||(Q[0]=p=>u.value=!1)})]),_:1}),e(I,null,{default:a(()=>[o.$route.path!=="/"?g((r(),i(d,{key:0,clickable:"",onClick:j},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"fas fa-dove"})]),_:1}),e(l,null,{default:a(()=>[s(n(o.$t("preface.return")),1)]),_:1})]),_:1})),[[b]]):y("",!0),o.$route.path!=="/"?(r(),i(L,{key:1})):y("",!0),f(c).isLoggedIn?(r(),C(E,{key:3},[e(d,null,{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(Y,null,{default:a(()=>[e(f(P),{size:40,variant:"beam",name:f(c).username,title:!0,colors:M},null,8,["name"])]),_:1})]),_:1}),e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[s(n(_.value),1)]),_:1}),e(k,{caption:""},{default:a(()=>[s(n(f(c).email),1)]),_:1})]),_:1})]),_:1}),e(L),g((r(),i(d,{clickable:"",to:{name:"dashboard"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"dashboard"})]),_:1}),e(l,null,{default:a(()=>[s(n(o.$t("nav.dashboard")),1)]),_:1})]),_:1})),[[b]]),f(c).role==="admin"?g((r(),i(d,{key:0,clickable:"",to:{name:"admin"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"admin_panel_settings"})]),_:1}),e(l,null,{default:a(()=>[s(n(o.$t("nav.admin")),1)]),_:1})]),_:1})),[[b]]):y("",!0),g((r(),i(d,{clickable:"",onClick:z},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"logout"})]),_:1}),e(l,null,{default:a(()=>[s(n(o.$t("nav.logout")),1)]),_:1})]),_:1})),[[b]])],64)):g((r(),i(d,{key:2,clickable:"",to:{name:"login"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"login"})]),_:1}),e(l,null,{default:a(()=>[s(n(o.$t("nav.login")),1)]),_:1})]),_:1})),[[b]]),e(L),e(k,{header:""},{default:a(()=>[s(n(o.$t("nav.language")),1)]),_:1}),(r(),C(E,null,A(B,p=>g(e(d,{key:p.value,clickable:"",onClick:J=>R(p.value)},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"translate"})]),_:1}),e(l,null,{default:a(()=>[s(n(p.text),1)]),_:2},1024)]),_:2},1032,["onClick"]),[[b]])),64)),e(L),e(d,null,{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"brightness_medium"})]),_:1}),e(l,null,{default:a(()=>[s(n(o.$t("nav.theme")),1)]),_:1}),e(l,{side:""},{default:a(()=>[e(N)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","width"]),e(de,null,{default:a(()=>[e(G)]),_:1})]),_:1})}}},Ve=ae(_e,[["__scopeId","data-v-5f805108"]]);export{Ve as default};
