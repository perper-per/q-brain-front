import{Q as P,a as H,z as X,b as Z,c as x}from"./vue-boring-avatars-z-630R_4.js";import{h as ee,i as ae,r as W,o as S,d as s,j as m,Q as $,u as te,k as oe,l as le,m as Y,w as ne,a as se,n as re,p as a,q as de,g as e,s as u,e as y,t as n,v as A,x as r,y as v,z as w,F as I,A as N,B as _,f as ue,C as ie}from"./index-CvvTYKRz.js";import{Q as g}from"./QItemLabel-CcqCRaXJ.js";import{Q as i,a as l}from"./QItem-DFdmOnk6.js";import{Q as M}from"./QList-CLJjQapR.js";import{Q as me}from"./use-id-BMWXaBJN.js";import{Q as ce}from"./QBtnDropdown-CZ10Wlot.js";import{Q as T}from"./QSeparator-B5VrB1z_.js";import{C as k}from"./ClosePopup-BnnCX-DI.js";import{u as fe}from"./use-quasar-CEZ7aosB.js";import{u as pe}from"./useLocomotiveScroll-CgAB_SLO.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-prevent-scroll-By5kXq6w.js";import"./use-timeout-D10G5DZ1.js";import"./use-dark-DSCsLu_p.js";import"./TouchPan-RdITtxhG.js";import"./format-dCatN8Gn.js";import"./QBtnGroup-CW4WvxJ4.js";const he=ee({name:"QSpace",setup(){const q=ae("div",{class:"q-space"});return()=>q}}),U={__name:"ThemeToggle",setup(q){document.startViewTransition||(document.startViewTransition=o=>o());const c=W(!1);function Q(o){document.startViewTransition(()=>{o==="dark"?(c.value=!0,document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(c.value=!1,document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))})}S(()=>{const o=localStorage.getItem("theme");(o==="dark"||!o&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(c.value=!0,document.documentElement.classList.add("dark"))});const E=o=>{const h=`${Math.floor(o.clientX/window.innerWidth*100)}%`,b=`${Math.floor(o.clientY/window.innerHeight*100)}%`;document.documentElement.style=`--pointerX: ${h}; --pointerY: ${b};`},f=o=>{const h=`${Math.floor(o.touches[0].clientX/window.innerWidth*100)}%`,b=`${Math.floor(o.touches[0].clientY/window.innerHeight*100)}%`;document.documentElement.style=`--pointerX: ${h}; --pointerY: ${b};`};return S(()=>{const o=localStorage.getItem("theme");(o==="dark"||!o&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(c.value=!0,document.documentElement.classList.add("dark")),document.addEventListener("mousedown",E),document.addEventListener("touchstart",f)}),(o,h)=>(s(),m($,{flat:"",dense:"",round:"",icon:c.value?"dark_mode":"light_mode",onClick:h[0]||(h[0]=b=>Q(c.value?"light":"dark")),class:"theme-toggle"},null,8,["icon"]))}},_e={key:0},ge={key:1,class:"text-h6"},ke={key:0,class:"desktop-nav"},be={class:"mobile-menu-btn"},ye={__name:"MainLayout",setup(q){const c=te(),{t:Q,locale:E}=oe(),f=le(),o=fe(),{initLocomotiveScroll:h,destroyLocomotiveScroll:b}=pe();let C=null;const z=Y(()=>f.username?.toLowerCase()),B=["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"],d=W(!1),F=Y(()=>(o.screen.lt.sm,280));function R(){c.push("/site"),d.value=!1}const j=t=>{E.value=t},D=async()=>{try{await f.logout(),o.notify({type:"positive",message:Q("logout.success"),position:"top"}),c.push("/site/login"),d.value=!1}catch(t){console.error("Logout error:",t),o.notify({type:"negative",message:Q("logout.error"),position:"top"})}},V=[{text:"繁體中文",value:"zh-TW"},{text:"English",value:"en-US"}];ne(()=>o.screen.name,t=>{(t==="md"||t==="lg"||t==="xl")&&(d.value=!1)}),c.afterEach(()=>{setTimeout(()=>{C&&C.update(),d.value=!1},100)}),S(()=>{C=h(),window.locomotiveScroll=C,console.log("元件掛載，目前螢幕類型:",o.screen.name),console.log("是否為行動裝置:",o.screen.lt.md),window.addEventListener("resize",()=>{console.log("螢幕大小變化，目前螢幕類型:",o.screen.name),console.log("是否為行動裝置:",o.screen.lt.md)});const t=document.createElement("style");t.innerHTML=`
    body.body--dark .q-menu,
    body.body--dark .q-popover,
    body.body--dark .q-tooltip {
      background-color: #1d1d1d !important;
      color: #ffffff !important;
    }

    body.body--dark .q-menu *,
    body.body--dark .q-popover *,
    body.body--dark .q-tooltip * {
      background-color: #1d1d1d !important;
    }
  `,document.head.appendChild(t)}),se(()=>{b()});const O=()=>{c.push("/"),d.value=!1},G=()=>{console.log("選單按鈕點擊，目前抽屜狀態:",d.value),d.value=!d.value,console.log("抽屜新狀態:",d.value)};return(t,L)=>{const J=re("router-view");return s(),m(de,{view:"hHh Lpr lff"},{default:a(()=>[e(Z,{class:"main-header header-z-index fixed-header",bordered:""},{default:a(()=>[e(P,{class:"header-toolbar"},{default:a(()=>[e(H,{onClick:R,class:"cursor-pointer"},{default:a(()=>[u(o).screen.lt.sm?(s(),y("span",ge,n(t.$t("nav.shortTitle")||t.$t("nav.title").substring(0,3)),1)):(s(),y("span",_e,n(t.$t("nav.title")),1))]),_:1}),e(he),u(o).screen.lt.md?w("",!0):(s(),y("div",ke,[u(f).isLoggedIn?(s(),m($,{key:1,flat:""},{default:a(()=>[e(A,{size:"sm",class:"q-mr-sm"},{default:a(()=>[e(u(X),{size:25,variant:"beam",name:u(f).username,title:!0,colors:B},null,8,["name"])]),_:1}),r(" "+n(z.value)+" ",1),e(me,null,{default:a(()=>[e(M,{style:{"min-width":"150px"}},{default:a(()=>[e(i,{clickable:"",onClick:D},{default:a(()=>[e(l,null,{default:a(()=>[e(g,null,{default:a(()=>[e(v,{name:"logout",size:"sm",class:"q-mr-sm"}),r(" "+n(t.$t("nav.logout")),1)]),_:1})]),_:1})]),_:1}),e(i,{clickable:"",to:"/site/dashboard"},{default:a(()=>[e(l,null,{default:a(()=>[e(g,null,{default:a(()=>[e(v,{name:"dashboard",size:"sm",class:"q-mr-sm"}),r(" "+n(t.$t("nav.dashboard")),1)]),_:1})]),_:1})]),_:1}),u(f).role==="admin"?(s(),m(i,{key:0,clickable:"",to:{name:"admin"}},{default:a(()=>[e(l,null,{default:a(()=>[e(g,null,{default:a(()=>[e(v,{name:"admin_panel_settings",size:"sm",class:"q-mr-sm"}),r(" "+n(t.$t("nav.admin")),1)]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})]),_:1})):(s(),m($,{key:0,flat:"",label:t.$t("nav.login"),to:{name:"login"}},null,8,["label"])),e(ce,{flat:"",icon:"translate"},{default:a(()=>[e(M,null,{default:a(()=>[(s(),y(I,null,N(V,p=>_(e(i,{key:p.value,clickable:"",onClick:K=>t.$i18n.locale=p.value},{default:a(()=>[e(l,null,{default:a(()=>[e(g,null,{default:a(()=>[r(n(p.text),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]),[[k]])),64))]),_:1})]),_:1}),e(U)])),ue("div",be,[u(o).screen.lt.md?(s(),m($,{key:0,dense:"",flat:"",round:"",icon:"menu",onClick:G})):w("",!0)])]),_:1})]),_:1}),e(x,{modelValue:d.value,"onUpdate:modelValue":L[1]||(L[1]=p=>d.value=p),side:"right",overlay:"",elevated:"",width:F.value,class:"mobile-drawer"},{default:a(()=>[e(P,{class:"drawer-header"},{default:a(()=>[e(H,null,{default:a(()=>[r(n(t.$t("nav.menu")),1)]),_:1}),e($,{flat:"",round:"",dense:"",icon:"close",onClick:L[0]||(L[0]=p=>d.value=!1)})]),_:1}),e(M,null,{default:a(()=>[t.$route.path!=="/"?_((s(),m(i,{key:0,clickable:"",onClick:O},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"fas fa-dove"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("preface.return")),1)]),_:1})]),_:1})),[[k]]):w("",!0),t.$route.path!=="/"?(s(),m(T,{key:1})):w("",!0),u(f).isLoggedIn?(s(),y(I,{key:3},[e(i,null,{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(A,null,{default:a(()=>[e(u(X),{size:40,variant:"beam",name:u(f).username,title:!0,colors:B},null,8,["name"])]),_:1})]),_:1}),e(l,null,{default:a(()=>[e(g,null,{default:a(()=>[r(n(z.value),1)]),_:1}),e(g,{caption:""},{default:a(()=>[r(n(u(f).email),1)]),_:1})]),_:1})]),_:1}),e(T),_((s(),m(i,{clickable:"",to:{name:"dashboard"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"dashboard"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.dashboard")),1)]),_:1})]),_:1})),[[k]]),u(f).role==="admin"?_((s(),m(i,{key:0,clickable:"",to:{name:"admin"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"admin_panel_settings"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.admin")),1)]),_:1})]),_:1})),[[k]]):w("",!0),_((s(),m(i,{clickable:"",onClick:D},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"logout"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.logout")),1)]),_:1})]),_:1})),[[k]])],64)):_((s(),m(i,{key:2,clickable:"",to:{name:"login"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"login"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.login")),1)]),_:1})]),_:1})),[[k]]),e(T),e(g,{header:""},{default:a(()=>[r(n(t.$t("nav.language")),1)]),_:1}),(s(),y(I,null,N(V,p=>_(e(i,{key:p.value,clickable:"",onClick:K=>j(p.value)},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"translate"})]),_:1}),e(l,null,{default:a(()=>[r(n(p.text),1)]),_:2},1024)]),_:2},1032,["onClick"]),[[k]])),64)),e(T),e(i,null,{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"brightness_medium"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.theme")),1)]),_:1}),e(l,{side:""},{default:a(()=>[e(U)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","width"]),e(ie,{"data-scroll-container":""},{default:a(()=>[e(J)]),_:1})]),_:1})}}},Ye=ve(ye,[["__scopeId","data-v-bf997296"]]);export{Ye as default};
