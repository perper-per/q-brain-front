import{Q as V,a as S,z as P,b as J,c as K}from"./vue-boring-avatars-WlfLFSic.js";import{i as Z,j as x,r as N,o as D,e as s,k as m,Q as $,u as ee,l as ae,m as te,n as H,w as oe,d as le,p as ne,q as a,s as se,h as e,v as u,f as y,t as n,x as X,y as r,z as v,A as w,F as E,B as Y,C as g,g as re,D as de}from"./index-D3qZjs4i.js";import{Q as k}from"./QItemLabel-CrtRBPfC.js";import{Q as i,a as l}from"./QItem-CJXmauC-.js";import{Q as I}from"./QList-G9K4O4SE.js";import{Q as ue}from"./use-id-CMZunb2M.js";import{Q as ie}from"./QBtnDropdown-Ch564kvL.js";import{Q as L}from"./QSeparator-DydFsrhi.js";import{C as b}from"./ClosePopup-tqwT_9ep.js";import{u as me}from"./use-quasar-DABIMPIJ.js";import{u as ce}from"./useLocomotiveScroll-jY2L2lUG.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-prevent-scroll-DrnYvAOW.js";import"./use-timeout-CcuabLrH.js";import"./use-dark-PHRrv4w4.js";import"./TouchPan-BWfXzsNT.js";import"./format-dCatN8Gn.js";import"./QBtnGroup-BszRbzrj.js";const pe=Z({name:"QSpace",setup(){const T=x("div",{class:"q-space"});return()=>T}}),A={__name:"ThemeToggle",setup(T){document.startViewTransition||(document.startViewTransition=o=>o());const c=N(!1);function Q(o){document.startViewTransition(()=>{o==="dark"?(c.value=!0,document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(c.value=!1,document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))})}D(()=>{const o=localStorage.getItem("theme");(o==="dark"||!o&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(c.value=!0,document.documentElement.classList.add("dark"))});const q=o=>{const h=`${Math.floor(o.clientX/window.innerWidth*100)}%`,_=`${Math.floor(o.clientY/window.innerHeight*100)}%`;document.documentElement.style=`--pointerX: ${h}; --pointerY: ${_};`},f=o=>{const h=`${Math.floor(o.touches[0].clientX/window.innerWidth*100)}%`,_=`${Math.floor(o.touches[0].clientY/window.innerHeight*100)}%`;document.documentElement.style=`--pointerX: ${h}; --pointerY: ${_};`};return D(()=>{const o=localStorage.getItem("theme");(o==="dark"||!o&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(c.value=!0,document.documentElement.classList.add("dark")),document.addEventListener("mousedown",q),document.addEventListener("touchstart",f)}),(o,h)=>(s(),m($,{flat:"",dense:"",round:"",icon:c.value?"dark_mode":"light_mode",onClick:h[0]||(h[0]=_=>Q(c.value?"light":"dark")),class:"theme-toggle"},null,8,["icon"]))}},ve={key:0},he={key:1,class:"text-h6"},_e={key:0,class:"desktop-nav"},ge={class:"mobile-menu-btn"},ke={__name:"MainLayout",setup(T){const c=ee(),{t:Q,locale:q}=ae(),f=te(),o=me(),{destroyLocomotiveScroll:h}=ce(),_=H(()=>f.username?.toLowerCase()),M=["#92A1C6","#146A7C","#F0AB3D","#C271B4","#C20D90"],d=N(!1),U=H(()=>(o.screen.lt.sm,280));function W(){c.push("/site"),d.value=!1}const F=t=>{q.value=t},z=async()=>{try{await f.logout(),o.notify({type:"positive",message:Q("logout.success"),position:"top"}),c.push("/site/login"),d.value=!1}catch(t){console.error("Logout error:",t),o.notify({type:"negative",message:Q("logout.error"),position:"top"})}},B=[{text:"繁體中文",value:"zh-TW"},{text:"English",value:"en-US"}];oe(()=>o.screen.name,t=>{(t==="md"||t==="lg"||t==="xl")&&(d.value=!1)}),c.afterEach(()=>{setTimeout(()=>{d.value=!1},100)}),D(()=>{console.log("元件掛載，目前螢幕類型:",o.screen.name),console.log("是否為行動裝置:",o.screen.lt.md),window.addEventListener("resize",()=>{console.log("螢幕大小變化，目前螢幕類型:",o.screen.name),console.log("是否為行動裝置:",o.screen.lt.md)});const t=document.createElement("style");t.innerHTML=`
    body.body--dark .q-menu,
    body.body--dark .q-popover,
    body.body--dark .q-tooltip {
      background-color: #1d1d1d !important;
      color: #ffffff !important;
    }

    body.body--dark .q-menu *,
    body.body--dark .q-popover *,
    body.body--dark .q-tooltip * {
      background-color: #1d1d1d !important;
    }
  `,document.head.appendChild(t)}),le(()=>{h()});const R=()=>{c.push("/"),d.value=!1},j=()=>{console.log("選單按鈕點擊，目前抽屜狀態:",d.value),d.value=!d.value,console.log("抽屜新狀態:",d.value)};return(t,C)=>{const O=ne("router-view");return s(),m(se,{view:"hHh Lpr lff"},{default:a(()=>[e(J,{class:"main-header header-z-index fixed-header",bordered:""},{default:a(()=>[e(V,{class:"header-toolbar"},{default:a(()=>[e(S,{onClick:W,class:"cursor-pointer"},{default:a(()=>[u(o).screen.lt.sm?(s(),y("span",he,n(t.$t("nav.shortTitle")||t.$t("nav.title").substring(0,3)),1)):(s(),y("span",ve,n(t.$t("nav.title")),1))]),_:1}),e(pe),u(o).screen.lt.md?w("",!0):(s(),y("div",_e,[u(f).isLoggedIn?(s(),m($,{key:1,flat:""},{default:a(()=>[e(X,{size:"sm",class:"q-mr-sm"},{default:a(()=>[e(u(P),{size:25,variant:"beam",name:u(f).username,title:!0,colors:M},null,8,["name"])]),_:1}),r(" "+n(_.value)+" ",1),e(ue,null,{default:a(()=>[e(I,{style:{"min-width":"150px"}},{default:a(()=>[e(i,{clickable:"",onClick:z},{default:a(()=>[e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[e(v,{name:"logout",size:"sm",class:"q-mr-sm"}),r(" "+n(t.$t("nav.logout")),1)]),_:1})]),_:1})]),_:1}),e(i,{clickable:"",to:"/site/dashboard"},{default:a(()=>[e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[e(v,{name:"dashboard",size:"sm",class:"q-mr-sm"}),r(" "+n(t.$t("nav.dashboard")),1)]),_:1})]),_:1})]),_:1}),u(f).role==="admin"?(s(),m(i,{key:0,clickable:"",to:{name:"admin"}},{default:a(()=>[e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[e(v,{name:"admin_panel_settings",size:"sm",class:"q-mr-sm"}),r(" "+n(t.$t("nav.admin")),1)]),_:1})]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1})]),_:1})):(s(),m($,{key:0,flat:"",label:t.$t("nav.login"),to:"/site/login"},null,8,["label"])),e(ie,{flat:"",icon:"translate"},{default:a(()=>[e(I,null,{default:a(()=>[(s(),y(E,null,Y(B,p=>g(e(i,{key:p.value,clickable:"",onClick:G=>t.$i18n.locale=p.value},{default:a(()=>[e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[r(n(p.text),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]),[[b]])),64))]),_:1})]),_:1}),e(A)])),re("div",ge,[u(o).screen.lt.md?(s(),m($,{key:0,dense:"",flat:"",round:"",icon:"menu",onClick:j})):w("",!0)])]),_:1})]),_:1}),e(K,{modelValue:d.value,"onUpdate:modelValue":C[1]||(C[1]=p=>d.value=p),side:"right",overlay:"",elevated:"",width:U.value,class:"mobile-drawer"},{default:a(()=>[e(V,{class:"drawer-header"},{default:a(()=>[e(S,null,{default:a(()=>[r(n(t.$t("nav.menu")),1)]),_:1}),e($,{flat:"",round:"",dense:"",icon:"close",onClick:C[0]||(C[0]=p=>d.value=!1)})]),_:1}),e(I,null,{default:a(()=>[t.$route.path!=="/"?g((s(),m(i,{key:0,clickable:"",onClick:R},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"fas fa-dove"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("preface.return")),1)]),_:1})]),_:1})),[[b]]):w("",!0),t.$route.path!=="/"?(s(),m(L,{key:1})):w("",!0),u(f).isLoggedIn?(s(),y(E,{key:3},[e(i,null,{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(X,null,{default:a(()=>[e(u(P),{size:40,variant:"beam",name:u(f).username,title:!0,colors:M},null,8,["name"])]),_:1})]),_:1}),e(l,null,{default:a(()=>[e(k,null,{default:a(()=>[r(n(_.value),1)]),_:1}),e(k,{caption:""},{default:a(()=>[r(n(u(f).email),1)]),_:1})]),_:1})]),_:1}),e(L),g((s(),m(i,{clickable:"",to:{name:"dashboard"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"dashboard"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.dashboard")),1)]),_:1})]),_:1})),[[b]]),u(f).role==="admin"?g((s(),m(i,{key:0,clickable:"",to:{name:"admin"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"admin_panel_settings"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.admin")),1)]),_:1})]),_:1})),[[b]]):w("",!0),g((s(),m(i,{clickable:"",onClick:z},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"logout"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.logout")),1)]),_:1})]),_:1})),[[b]])],64)):g((s(),m(i,{key:2,clickable:"",to:{name:"login"}},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"login"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.login")),1)]),_:1})]),_:1})),[[b]]),e(L),e(k,{header:""},{default:a(()=>[r(n(t.$t("nav.language")),1)]),_:1}),(s(),y(E,null,Y(B,p=>g(e(i,{key:p.value,clickable:"",onClick:G=>F(p.value)},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"translate"})]),_:1}),e(l,null,{default:a(()=>[r(n(p.text),1)]),_:2},1024)]),_:2},1032,["onClick"]),[[b]])),64)),e(L),e(i,null,{default:a(()=>[e(l,{avatar:""},{default:a(()=>[e(v,{name:"brightness_medium"})]),_:1}),e(l,null,{default:a(()=>[r(n(t.$t("nav.theme")),1)]),_:1}),e(l,{side:""},{default:a(()=>[e(A)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","width"]),e(de,null,{default:a(()=>[e(O)]),_:1})]),_:1})}}},He=fe(ke,[["__scopeId","data-v-1d8aa88f"]]);export{He as default};
